# Mitochondrial Motility Model
This model was created to provide additional validation for experimental work by Catia Silva and Christian Lohmann at 
the [Netherland Institute for Neuroscience](https://nin.nl/research/researchgroups/lohmann-groep/).

We explored the effects of simulated synaptic activity on a pool of mitochondria with normally distributed stopping times.
We also generated dose response curves varying synatpic event frequencies on pools of mitochondria with varying mean stopping times.
Experiments as in the paper can be generated by running `main.py` directly. By default this does not save plots of simulation results,
but changing the plotting arguments passed to the main function will generate saved plots in the folder `data/`. 

The notebook `walkthrough.ipynb` gives examples of how functions are used to produce the results presented in our paper.

## Spike Train Generation
To generate simulated synaptic activity, we used the homogeneous Poisson process function from the [Elephant](https://elephant.readthedocs.io/en/latest/) package. 

The function `get_spike_trains` generates a list of times at which a simulated synaptic activity occurs. 
This function takes arguments `num_runs` and `event_hz` which specify how many simulated spike trains to generate, and the frequency of spikes respectively.

If `event_hz` is a list of multiple frequencies, the function will generate spike trains with each frequency generated for a fixed block of time (specified by the parameter `freq_block`). 

An example raster plot with multiple spike frequencies (by default each block = 1500s): 

![image](./data/SpikeRasters/example_spike_train.png)

## Simulating a Pool of Mitochondria 
We modeled the effect of synaptic inputs of varying frequency on pools of mitochondria with different mean stopping times. 
Each experiment involved a new population of 500 instances of the `mitochondrion` object class defined in `util.py`, where 
mitochondrial stopping times were drawn from a normal distribution with a set mean (µ = 1–5 min, σ = 2.5 min). This population
was then used with an example spike train (generated as above). We repeated this process varying the mean stopping time and the 
frequency of synaptic spikes.

### Stopping Times
Mito stopping times are an attribute of each instantiation of the `mitochondrion` class defined in `util.py`. 
For a given population of mitochondria, each member has its own stopping time.


In the function `F.populate_list_n` the parameter `noisy_recovery` is by default True, 
which means mito stopping times are drawn from a normal distribution with  $\mu$= `recov_mean` and  $\sigma$=  `recov_sd`. 
If `noisy_recovery` is False, all mitos have a stopping time of `recov_mean`.

Population stopping time histograms are generated by the function `mito_stop_hist` in `plotting.py`. 

An example histogram of mitochondrial stopping times: 

![image](./data/Histograms/Mito_freezing_histogram_360sec.png)

### Recovery Times
For each synaptic event, a subset of the mobile mitochondria are selected for immobilization. Each mitochondrion remains 
immobile for the duration of its stopping time. After this time has elapsed, the mitochondrion returns to the mobile fraction.

An example plot of the fraction of mitochondria in the mobile pool in response to a fixed-frequency synaptic input:
![image](./data/MeanRecovTimes/360sec/AvgMitoMotility0.058.png)